function buildLink(t,e,n){var a,r="",i=["format=json","action=query"];return a="search"===e?["list=search","srsearch="+n]:["generator=random","grnnamespace=0","grnlimit=1","prop=extracts","exintro="],a=_.union(i,a),_.each(a,function(t){r=r+"&"+t}),t+r}function startDisplay(){console.log("starting");var t=$(".search").val().trim(),e="";t.length>0?(type="search",e=buildLink(base_url,type,t)):(type="",e=buildLink(base_url)),getData(e,type)}function request(t){return $(".current-wiki").addClass("loading"),$(".intro").html(""),$(".title").html(""),$(".article-link").html(""),$.ajax({url:t,type:"GET",dataType:"jsonp"})}function getData(t,e){request(t).done(function(t){displayData(e?t.query.search[0]:t.query.pages[_.keys(t.query.pages)[0]])})}function displayData(t){var e=t.extract||t.snippet;$(".current-wiki").removeClass("loading");var n=t.title,a=randomNum(-1,1);$(".current-wiki").css("transform","rotate("+a+"deg)"),$(".title").html(n),$(".intro").html(getFirstP(e)),$(".article-link").attr("href",articleLink(n)).html("w")}function getFirstP(t){return t.split("</p>")[0]+"</p>"}function articleLink(t){return t=t.replace(/\s/g,"_"),"http://en.wikipedia.org/wiki/"+t}function randomNum(t,e){return(Math.random()*e+t)*(Math.random()<.5?-1:1)}function changeText(t){console.log("changing",t),$(".button-text").html(t)}console.log("%cLet me know if you have any questions.","color:red;");var base_url="https://en.wikipedia.org/w/api.php?",type="",wikiAPI_URL=buildLink(base_url);$(function(){getData(wikiAPI_URL),$(".discard").on("click",startDisplay),$(document).keyup(function(t){13===t.keyCode&&startDisplay()}),$(".search").keyup(function(){changeText($(this).val().trim().length>0?"Search":"Redeal")})});